# 基于现有的CTF Agent镜像，只添加缺失的工具
FROM docker-ctf-agent:latest

# 切换到root用户来安装额外工具
USER root

# 安装缺失的工具
RUN apt-get update && \
    apt-get install -y --fix-missing \
    upx \
    && apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# 安装radare2
RUN git clone --depth 1 https://github.com/radareorg/radare2.git /tmp/radare2 && \
    cd /tmp/radare2 && \
    ./sys/install.sh --install && \
    cd / && \
    rm -rf /tmp/radare2

# 切换回ctfuser
USER ctfuser

# 设置工作目录
WORKDIR /app
